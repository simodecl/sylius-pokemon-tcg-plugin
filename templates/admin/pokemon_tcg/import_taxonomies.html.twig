{% extends '@SyliusAdmin/layout.html.twig' %}

{% block title %}Pokemon TCG - Import Categories{% endblock %}

{% block content %}
<div class="ui segment">
    <h1 class="ui header">
        <i class="download icon"></i>
        <div class="content">
            Import Pokemon TCG Categories
            <div class="sub header">Import series and sets from TCGdex as Sylius taxons</div>
        </div>
    </h1>
</div>

{% for message in app.flashes('success') %}
    <div class="ui positive message">
        <i class="close icon"></i>
        <p>{{ message }}</p>
    </div>
{% endfor %}

{% for message in app.flashes('error') %}
    <div class="ui negative message">
        <i class="close icon"></i>
        <p>{{ message }}</p>
    </div>
{% endfor %}

<div class="ui segment">
    <h3 class="ui header">Import All</h3>
    <p>Import all series and their sets at once. Existing categories will be skipped (not duplicated).</p>
    <form method="post" action="{{ path('simo_decl_pokemon_tcg_admin_import_all_taxonomies') }}">
        <input type="hidden" name="_token" value="{{ csrf_token('pokemon_tcg_import') }}">
        <button type="submit" class="ui primary button" onclick="return confirm('This will import all series and sets from TCGdex. This may take a moment. Continue?')">
            <i class="download icon"></i>
            Import All Series &amp; Sets
        </button>
    </form>
</div>

<div class="ui segment">
    <h3 class="ui header">Import by Series</h3>
    <p>Select individual series to import. Click "Import" next to a series to import it and all its sets.</p>

    <table class="ui celled striped table">
        <thead>
            <tr>
                <th>Series ID</th>
                <th>Series Name</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for serie in series %}
                <tr>
                    <td><code>{{ serie.id }}</code></td>
                    <td>
                        {% if serie.logo is defined and serie.logo %}
                            <img src="{{ serie.logo }}/low.png" alt="{{ serie.name }}" style="height: 30px; vertical-align: middle; margin-right: 8px;">
                        {% endif %}
                        {{ serie.name }}
                    </td>
                    <td>
                        <form method="post" action="{{ path('simo_decl_pokemon_tcg_admin_import_serie', {serieId: serie.id}) }}" style="display: inline">
                            <input type="hidden" name="_token" value="{{ csrf_token('pokemon_tcg_import') }}">
                            <button type="submit" class="ui small primary button">
                                <i class="download icon"></i>
                                Import Series
                            </button>
                        </form>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="3">
                        <div class="ui warning message">
                            Could not fetch series from TCGdex. Check your internet connection and try again.
                        </div>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
