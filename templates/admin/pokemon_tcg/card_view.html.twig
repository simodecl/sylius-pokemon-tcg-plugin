{% extends '@SyliusAdmin/shared/layout/base.html.twig' %}

{% block title %}Pokemon TCG - {{ card.name }}{% endblock %}

{% block body %}
<div class="container-fluid py-3">
    <a href="{{ path('simo_decl_pokemon_tcg_admin_card_search') }}" class="btn btn-outline-secondary mb-3">&larr; Back to Search</a>

    {% for message in app.flashes('success') %}
        <div class="alert alert-success alert-dismissible fade show">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    {% endfor %}

    {% for message in app.flashes('error') %}
        <div class="alert alert-danger alert-dismissible fade show">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    {% endfor %}

    <div class="row">
        <div class="col-md-4">
            {% if card.image %}
                <div class="card mb-3">
                    <img src="{{ card.image }}/high.png" alt="{{ card.name }}" class="card-img-top">
                </div>
            {% endif %}
        </div>

        <div class="col-md-8">
            <div class="card mb-3">
                <div class="card-body">
                    <h2>{{ card.name }}</h2>
                    <p class="text-muted">{{ card.id }}</p>

                    <table class="table">
                        <tbody>
                            {% if card.set %}
                                <tr>
                                    <th style="width:25%">Set</th>
                                    <td>{{ card.set.name }} ({{ card.set.id }})</td>
                                </tr>
                            {% endif %}
                            {% if card.localId %}
                                <tr>
                                    <th>Card Number</th>
                                    <td>{{ card.localId }}</td>
                                </tr>
                            {% endif %}
                            {% if card.rarity %}
                                <tr>
                                    <th>Rarity</th>
                                    <td>{{ card.rarity }}</td>
                                </tr>
                            {% endif %}
                            {% if card.category %}
                                <tr>
                                    <th>Category</th>
                                    <td>{{ card.category }}</td>
                                </tr>
                            {% endif %}
                            {% if card.hp %}
                                <tr>
                                    <th>HP</th>
                                    <td>{{ card.hp }}</td>
                                </tr>
                            {% endif %}
                            {% if card.types %}
                                <tr>
                                    <th>Types</th>
                                    <td>{{ card.types|join(', ') }}</td>
                                </tr>
                            {% endif %}
                            {% if card.stage %}
                                <tr>
                                    <th>Stage</th>
                                    <td>{{ card.stage }}</td>
                                </tr>
                            {% endif %}
                            {% if card.illustrator %}
                                <tr>
                                    <th>Illustrator</th>
                                    <td>{{ card.illustrator }}</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>

                    {% if card.description %}
                        <h5>Card Text</h5>
                        <p>{{ card.description }}</p>
                    {% endif %}
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Create Product</h5>
                    <p>Create a Sylius product from this card. It will be linked to the set category and have variants for each configured card language.</p>

                    <form method="post" action="{{ path('simo_decl_pokemon_tcg_admin_create_product_from_card', {cardId: card.id}) }}">
                        <input type="hidden" name="_token" value="{{ csrf_token('pokemon_tcg_create_product') }}">
                        <div class="mb-3">
                            <label class="form-label">Default price (in cents, optional)</label>
                            <div class="input-group">
                                <input type="number" name="default_price" class="form-control" placeholder="e.g., 499 for $4.99" min="0">
                                <span class="input-group-text">cents</span>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Create Product</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
